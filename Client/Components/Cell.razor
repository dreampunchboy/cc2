<div class="spreadsheet-cell @(Header ? "spreadsheet-cell--header" : "") @(Clickable ? "spreadsheet-cell--clickable" : "") @(Disabled ? "spreadsheet-cell--disabled" : "") @(Selected ? "spreadsheet-cell--selected" : "") @CssClass"
     style="@(InlineStyle ?? $"grid-column: {GridColumn}; grid-row: {GridRow};")"
     role="@(Clickable ? "button" : null)"
     tabindex="@(Clickable && !Disabled ? 0 : (int?)null)"
     @onclick="HandleClick"
     @onkeydown="HandleKeyDown">
    @if (Progress > 0)
    {
        <div class="spreadsheet-cell__progress-bg" style="width: @(Progress * 100)%"></div>
    }
    <span class="spreadsheet-cell__content">@Value</span>
</div>

@code {
    [Parameter] public string Value { get; set; } = "";
    [Parameter] public string GridColumn { get; set; } = "";
    [Parameter] public string GridRow { get; set; } = "";
    [Parameter] public bool Header { get; set; }
    [Parameter] public bool Clickable { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public string CssClass { get; set; } = "";
    [Parameter] public string? InlineStyle { get; set; }
    [Parameter] public bool Selected { get; set; }
    [Parameter] public double Progress { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }

    private async Task HandleClick()
    {
        if (Clickable && !Disabled && OnClick.HasDelegate)
            await OnClick.InvokeAsync();
    }

    private async Task HandleKeyDown(KeyboardEventArgs e)
    {
        if (Clickable && !Disabled && OnClick.HasDelegate && e.Key == "Enter")
            await OnClick.InvokeAsync();
    }
}
