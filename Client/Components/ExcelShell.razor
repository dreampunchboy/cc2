@* Excel-style shell: title bar, ribbon, formula bar, sheet tabs, status bar *@
<div class="excel-window">
    <header class="excel-title-bar">
        <div class="excel-title-bar__left">
            <span class="excel-title-bar__autosave">AutoSave</span>
            <span class="excel-title-bar__autosave-off">Off</span>
            <button type="button" class="excel-title-bar__icon" title="Save" aria-label="Save">ðŸ’¾</button>
            <button type="button" class="excel-title-bar__icon" title="Undo" aria-label="Undo">â†¶</button>
            <button type="button" class="excel-title-bar__icon" title="Redo" aria-label="Redo">â†·</button>
        </div>
        <div class="excel-title-bar__center">Book1</div>
        <div class="excel-title-bar__right">
            <div class="excel-title-bar__search">Search</div>
            <button type="button" class="excel-title-bar__share">Share</button>
            <button type="button" class="excel-title-bar__win" aria-label="Minimize">â”€</button>
            <button type="button" class="excel-title-bar__win" aria-label="Maximize">â–¡</button>
            <button type="button" class="excel-title-bar__win" aria-label="Close" @onclick="HandleCloseClick">âœ•</button>
        </div>
    </header>

    <div class="excel-ribbon">
        <div class="excel-ribbon__tabs">
            <span class="excel-ribbon__tab">File</span>
            <span class="excel-ribbon__tab excel-ribbon__tab--active">Home</span>
            <span class="excel-ribbon__tab">Insert</span>
            <span class="excel-ribbon__tab">Draw</span>
            <span class="excel-ribbon__tab">Page Layout</span>
            <span class="excel-ribbon__tab">Formulas</span>
            <span class="excel-ribbon__tab">Data</span>
            <span class="excel-ribbon__tab">Review</span>
            <span class="excel-ribbon__tab">View</span>
            <span class="excel-ribbon__tab">Automate</span>
            <span class="excel-ribbon__tab">Help</span>
        </div>
        <div class="excel-ribbon__content">
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Clipboard</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon" title="Paste">ðŸ“‹</span>
                    <span class="excel-ribbon__icon" title="Cut">âœ‚</span>
                    <span class="excel-ribbon__icon" title="Copy">ðŸ“„</span>
                    <span class="excel-ribbon__icon" title="Format Painter">ðŸ–Œ</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Font</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__font-name">Aptos Narrow</span>
                    <span class="excel-ribbon__font-size">11</span>
                    <span class="excel-ribbon__icon">B</span>
                    <span class="excel-ribbon__icon">I</span>
                    <span class="excel-ribbon__icon">U</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Alignment</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon">â‰¡</span>
                    <span class="excel-ribbon__icon">â‰£</span>
                    <span class="excel-ribbon__icon">âŠž</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Number</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon">General</span>
                    <span class="excel-ribbon__icon">$</span>
                    <span class="excel-ribbon__icon">%</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Styles</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon">Conditional Formatting</span>
                    <span class="excel-ribbon__icon">Format as Table</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Cells</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon">Insert</span>
                    <span class="excel-ribbon__icon">Delete</span>
                    <span class="excel-ribbon__icon">Format</span>
                </div>
            </div>
            <div class="excel-ribbon__group">
                <span class="excel-ribbon__group-label">Editing</span>
                <div class="excel-ribbon__icons">
                    <span class="excel-ribbon__icon">Î£ Sum</span>
                    <span class="excel-ribbon__icon">Fill</span>
                    <span class="excel-ribbon__icon">Clear</span>
                    <span class="excel-ribbon__icon">Sort & Filter</span>
                </div>
            </div>
        </div>
    </div>

    <div class="excel-formula-bar">
        <div class="excel-formula-bar__name-box" title="Name Box">@SelectedCellRef</div>
        <button type="button" class="excel-formula-bar__btn" aria-label="Cancel">Ã—</button>
        <button type="button" class="excel-formula-bar__btn" aria-label="Enter">âœ“</button>
        <button type="button" class="excel-formula-bar__fx" aria-label="Insert Function">fx</button>
        <div class="excel-formula-bar__input">@FormulaBarValue</div>
    </div>

    <div class="excel-grid-with-sidebar">
        <div class="excel-grid-area">
            @ChildContent
        </div>
        @if (SidebarContent != null)
        {
            @SidebarContent
        }
    </div>

    <div class="excel-sheet-bar">
        <div class="excel-sheet-bar__tabs">
            <button type="button" class="excel-sheet-bar__nav" aria-label="Previous sheet">â€¹</button>
            <button type="button" class="excel-sheet-bar__nav" aria-label="Next sheet">â€º</button>
            @SheetTabsContent
            <button type="button" class="excel-sheet-bar__add" aria-label="Insert sheet">+</button>
        </div>
        <div class="excel-status-bar">
            <span class="excel-status-bar__view">Ready</span>
            @if (StatusBarPromoteContent != null)
            {
                @StatusBarPromoteContent
            }
            <span class="excel-status-bar__totals">@AllSheetsPerSecondDisplay</span>
            <span class="excel-status-bar__zoom">100%</span>
        </div>
    </div>
</div>

@code {
    [Inject] private IJSRuntime JSRuntime { get; set; } = null!;

    [Parameter] public RenderFragment? SheetTabsContent { get; set; }
    [Parameter] public RenderFragment? ChildContent { get; set; }
    [Parameter] public RenderFragment? SidebarContent { get; set; }
    [Parameter] public string SelectedCellRef { get; set; } = "A1";
    [Parameter] public string FormulaBarValue { get; set; } = "";
    [Parameter] public string AllSheetsPerSecondDisplay { get; set; } = "";
    [Parameter] public RenderFragment? StatusBarPromoteContent { get; set; }

    private async Task HandleCloseClick()
    {
        await JSRuntime.InvokeVoidAsync("closeApp");
    }
}
